---
layout: post
title: linux死机的处理方式 
date: 2018-03-30
catalog: true
tags: 
    - linux 
---

# 换系统了

经过多方考究，今天终于换了个新系统，manjaro，这里顺便也记录一下装机的过程

# 装机

系统安装也是比较容易的，这里有一个注意事项，那就是装系统前把磁盘换成gpt分区，否则manjaro可能无法启动。

manjaro在安装的时候注意在磁盘分区的时候有一些标记的东西，例如boot、esp、llvm等。

# 软件

arch系软件五花八门，deepin支持的在这里也能找到，但是感觉优化其实并不是很好。

记得配置软件源，可以用

```(bash)
sudo pacman-mirrors -i -c China -m rank
```

注意更新缓存，用octopi就好

注意安装yaourt，不用安装它的gui版。在octopi中有一个外星人的绿色标记点一下就可以切换aur了。

其余可以参考我的[linux配置](https://github.com/yushuaizhao/config-linux)

# 不同

manjaro和ubuntu系还是很多不一样的，比如没有了sysctl.conf，直接在sysctl.d中创建即可。等等吧，可以从archlinux中找答案

# linux死机的集中处理方案

linux的图形界面死机很正常，反正我这么感觉。而且linux死机以后鼠标键盘完全gg。

一般而言死机的主要原因系统负载过高，此时各种操作全卡，而且如果强制关机不利于硬盘等硬件，有时还会无法启动。

## 切换tty

按ctrl+alt+F2(F1-F6都可以一试，有的F1可能是图形界面)，等一会就可以进入tty，用户名密码登录后用top查看高负载的进程，kill PID即可

## reisub

### 用法

reisub是linux内核自带的方法，这个方法可以在各种情况下安全地重启计算机。大家在键盘上找，可以找到一个叫做“Sys Rq”的键，在台机的键盘上通常与 Prt Sc 共键，在笔记本可能在其他位置，如 Delete。以台机为例，要使用这种方法需要按住 ctrl+Alt-Print(Sys Rq)，然后依次按下 reisub 这几个键，按完 b 系统就会重启。 

解释一下， Sys Rq 是一种叫做系统请求的东西，linux内核自带，reisub每一个代表一个操作，依次是：

unRaw 将键盘控制从 X Server 那里抢回来

tErminate 给所有进程发送 SIGTERM 信号，让他们自己解决善后

kIll 给所有进程发送 SIGKILL 信号，强制他们马上关闭

Sync 将所有数据同步至磁盘

Unmount 将所有分区挂载为只读模式

reBoot 重启 

可以通过busier（busy的比较级）协助记忆。

### 不管用？

这个东西是要开启的，并不是默认自带的。查看方法为

```
cat /proc/sys/kernel/sysrq
```

输出1就能用，否则就不行

临时的使用可以编辑

```
sudo sysctl -w kernel.sysrq=1
```

终生使用请在```/etc/sysctl.d/```中创建文件```99-sysctl.conf```，加入

```
kernel.sysrq=1
```